<html>
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <title>URL checking management</title>
    <style type="text/css">
    .definitionErrorRules{
    	height:31px;
    }
    </style>
	</head>
  <body>
	 <form  id="urlCheckForm" name="urlCheckForm" method="post">
	  <input type="hidden" id="id" name="id" value=""></input>
    <table width="100%">   
    <tr>
        <td colspan="2" class="label"  style="display: none;"><br/><span class="STYLE4" id="mainTitle">URL checking management</span></td>        
      </tr>  
      <tr>
	  <td  valign="top" >
	  <table width="100%" height="100%" class="table_border2">
	  <tr>
        <td width="120"  align="right" class="label">Name:</td>
        <td class="td_border">
        <div class="inputOver">
        	<input name="name"  type="text" id="name" value=""  style="width:100%"/>
        	</div>
        </td>
      </tr>
      <tr>
        <td width="120"  align="right" class="label">Checking Mode:</td>
        <td class="td_border">
	    <div id="optionsDiv" style="float:left;width:100%;height:100%;border-bottom:1px dashed #ccc;">
        <ul>
        <li>
        <input class="typeInput" id="type" type="radio" name="type" value="ping" checked="checked"/>
        <a class="tooltip type_ping" style="font-weight:normal;" title="Adopt HTTP request to read response code; if HTTP request config is not selected, there’s no property request."  href="javascript:void(0);">Ping</a>
        </li>
        <li>
        <input class="typeInput" id="type" type="radio" name="type" value="source"/>
        <a class="tooltip type_source" style="font-weight:normal;" title="When the web contains an exception text, trigger fetch exception."  href="javascript:void(0);">Source</a>
        </li>
        <li style="width:120px;">
        <input class="typeInput" id="type" type="radio" name="type" value="rules"/>
        <a class="tooltip type_rules" style="font-weight:normal;" title="Adopt crawling rules to match URL contents; if HTTP request config is not selected, the default status is to use HTTP request config of the task."  href="javascript:void(0);">Crawling Rules</a>
        </li>
        </ul>
        </div>
        
        <table id="optionTable" style="width:100%;">
        	<tr style="width:100%;">
	        	<td nowrap="nowrap"  width="100"  align="right" >
	        	</td>
	        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
	        	Error
	        	</td>
        	</tr>
        	<tr class="pingOption" style="width:100%;">
	        	<td nowrap="nowrap"  width="100"  align="right" >
	        	<a class="tooltip" href="javascript:void(0);" title="If the returned response code of HTTP request is a specific value(e.g.: 404), it means error is found" style="font-weight:normal;">Response Code:</a>
	        	</td>
	        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
	        	<input name="definitionErrorResponseCode"  type="text" id="definitionErrorResponseCode" value="404"  style="width:200px"/>
	        	</td>
        	</tr>
        	<tr class="sourceOption" style="display:none;width:100%;">
	        	<td nowrap="nowrap"  width="100"  align="right" >
	        	<a class="tooltip" href="javascript:void(0);" title="When the web contains an exception text, trigger fetch exception." style="font-weight:normal;">Source：</a>
	        	</td>
	        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
	        	<div>
	        		<div style="width: 690px;">
	        			<div>
		       			<select name="sourceContain" id="sourceContain" >
							<option value="true">Contain</option>
							<option value="false">Not Contain</option>
						</select>
						Enabled Regex<input name="sourceContainIsRegex" type="checkbox" id="sourceContainIsRegex" value="true" >
		       		 	<input name="sourceContainText"  type="text" id="sourceContainText" value=""  style="width:200px"/>
		       		 	</div>
	        		</div>
				</div>
	        	</td>
        	</tr>
        	<tr class="rulesOption" style="display:none;width:100%;">
	        	<td nowrap="nowrap"  width="100"  align="right" >
	        	<a class="tooltip" href="javascript:void(0);" title="If the record count in URL maching is smaller than a specific value, it means error is found" style="font-weight:normal;">Count is smaller than:</a>
	        	</td>
	        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
	        	<input name="definitionErrorCount"  type="text" id="definitionErrorCount" value="1"  style="width:200px"/>
	        	</td>
        	</tr>
        	<tr class="rulesOption" style="display:none;width:100%;">
	        	<td nowrap="nowrap"  width="100"  align="right" >
	        	<a class="tooltip" href="javascript:void(0);" title="Assign the crawling rule version to be checked, verify whether data matched by the label can satisfy the conditions; if not, it means error is found" style="font-weight:normal;">Rule Version</a>
	        	</td>
	        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
	        	<select id="crawlRulesVerId" name="crawlRulesVerId" style="width:160px;">
		          	<option value=""></option>
		       	</select>
	        	</td>
        	</tr>
        	<tr class="rulesOption" style="display:none;width:100%;">
	        	<td nowrap="nowrap"  width="100"  align="right" >
	        	Rules:
	        	</td>
	        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
	        	<div class="definitionErrorRulesDiv">
	        		<div id="definitionErrorRulesDiv1" class="definitionErrorRules" style="width: 690px;">
	        			<div class="definitionErrorRulesCondition" style="height: 25px; margin-top: 6px;float: left;width: 100px;">
	        			<input type="radio" name="cus_condition1" value="or" disabled="disabled">OR <input type="radio" name="cus_condition1" value="and" checked="checked"  disabled="disabled">AND
	        			</div>
	        			<div class="definitionErrorRulesLeft">
	        			<select id="cus_label" name="cus_label" style="width:160px;">
		          			<option value="" selected>Select Label </option>
		       			</select>
		       			<select name="cus_contain" id="cus_contain" >
							<option value="Y">Contain</option>
							<option value="N">Not Contain</option>
						</select>
						Enabled Regex<input name="cus_regex" type="checkbox" id="cus_regex" value="true" >
		       		 	<input name="cus_data"  type="text" id="cus_data" value=""  style="width:200px"/>
		       		 	</div>
		       		 	
		       		 	<div class="addLabel" style="margin-top: 3px;">
						<a class="addLabelDiv" href="javascript:void(0);">+</a>
						</div>
	        		</div>
		        	
				</div>
	        	</td>
	        	
        	</tr>
        </table>
        
        </td>
      </tr>
	  
      <tr>
        <td width="120"  align="right" class="label"><a class="tooltip" href="javascript:void(0);" title="Call the publish rule only when exceeding the error time allowed" >Error Time Limit:</a></td>
        <td class="td_border">
        <input name="errorTimesAllowed" type="text" id="errorTimesAllowed" value="0" width="100">
        </td>
      </tr>
      <tr>
        <td width="120"  align="right" class="label">Error Action:</td>
        <td class="td_border">
	     	<input class="optionInput" name="isDeploy" type="checkbox" id="isDeploy" value="true">
			<a class="tooltip" style="font-weight:normal;" title="Call the publish rules, read error reports in publish rules by  '${ERROR_REPORT}' "  href="javascript:void(0);">Call Publish Rules</a>
	        
	        <input  class="optionInput" name="isChangeUrlStatus" type="checkbox" id="isChangeUrlStatus" value="true" >
        	<a class="tooltip" style="font-weight:normal;" title="When error is found in the URL checked, change the URL status. If URL status is changed into -44, URL crawling would stop."  href="javascript:void(0);">Update URL Status</a>
        	
        	<input name="isTriggerException" type="checkbox" id="isTriggerException" value="true">
        	<a class="tooltip" style="font-weight:normal;" title="Trigger fetch exception, retry fetch current url."  href="javascript:void(0);">Trigger Exception</a>
        	
        	<input id="isSave" type="checkbox" name="isSave" value="true"/>Save Check Result
        	
	        <table >
	        	<tr id="isDeploy_option" style="display:none;width:100%;">
		        	<td nowrap="nowrap"  width="100"  align="right" >
		        	Publish Rules：
		        	</td>
		        	<td  style="width:100%;"   align="left" colspan="3" nowrap>
		        	<select id="deployId" name="deployId" style="width:160px;"></select>
		        	</td>
	        	</tr>
	        	<tr id="isChangeUrlStatus_option" style="display:none;width:100%;">
			       	<td nowrap="nowrap"  width="100"  align="right" >
	       		 	URL Status：
	       		 	</td>
			        <td  style="width:100%;"   align="left" colspan="3" nowrap>
	       		 	<input name="changeUrlStatus"  type="text" id="changeUrlStatus" value="-44"  style="width:60px"/>
		        	</td>
        		</tr>
	        </table>
        </td>
      </tr>
      <tr>
        <td ></td>
        <td class="td_border">
       	 	<input class="createBtn" type="button" value="Create">
			<input class="removeBtn" type="button" value="Remove">
			<input class="updateBtn" type="button" value="Update">
        </td>
      </tr>
      <tr>
      <td ></td>
      <td align="left" style="padding:0px 5px 5px 5px;color:red;" >
      <br/>
      </td>
      </tr>
       <tr>
			<td colspan="2">
				<table id="urlCheckTable"  width="100%" align="center" class="table_border2 tableList" style="border:1px solid #CCCCCC;border-collapse:collapse;background-color: #FFFFFF;">
					<tr>
						<td width="5%" nowrap bgcolor="whiteSmoke">&nbsp;Select</td>
						<td width="10%" nowrap bgcolor="whiteSmoke">&nbsp;&nbsp;&nbsp;Name</td>
						<td width="10%" nowrap bgcolor="whiteSmoke">Checking Mode</td>
						<td width="5%" nowrap bgcolor="whiteSmoke">Save Result</td>
						<td width="5%" nowrap bgcolor="whiteSmoke">Error Action</td>
						<td width="10%" nowrap bgcolor="whiteSmoke">Update Time</td>
					</tr>
				</table>
			</td>
		</tr>
	  </table>
	  
	  </td>
	  </tr>
	  
  </table>
  		 </form>
  <script type="text/javascript">
  $(document).ready(function() { 
	  var initFun=function(){
		  var formId;
		  var tableId;
		  if (!loadConfig) {
			  var id=$(document).find("#urlCheckForm").parents('.ui-tabs-panel').attr("id");
			  formId=id+" #urlCheckForm";
			  tableId=id+" #urlCheckTable";
		  }else{
				formId="config #urlCheckForm";
				tableId="config #urlCheckTable";
		  }
		  
			  var urlcheck=new urlcheckFun({
				  formId:formId,
				  tableId:tableId,
				  index:1,
				  webCrawlerId:webCrawlerId,
				  siteId:siteId,
				  jsonData:new Array(),
				  definitionErrorRules:null
			  });
			
			fillDeploy(urlcheck.v.formId, "deployId", false)
			fillRulesVer(urlcheck.v.formId, "crawlRulesVerId", true);
			
			urlcheck.fn.init();
			urlcheck.fn.query();
			
			poshytip('.tooltip');
		};
	  
		var initLoading=setInterval(function(){
			if(typeof urlcheck != 'undefined'){
				clearInterval(initLoading);
				initFun();
			}
		},500);
	});
  </script>
  </body>
</html>
