var systemConfig={v:{formId:"systemConfigForm",webCrawlerId:null},fn:{init:function(){fillCustomPlugin("1",systemConfig.v.formId,"urlfetchPluginId",true);fillQueue(systemConfig.v.formId,"queueName",true);systemConfig.fn.initSlider(5);$("#"+systemConfig.v.formId).find(".genRandomChar").click(function(){var a=genRandomChar(5);$("#"+systemConfig.v.formId+" input[name='system.property.rpcAuth']").val(a)});$("#shareSpiderForm input[name='system.property.share']").click(function(){systemConfig.fn.shareSpider()})},initSlider:function(a){$("#"+systemConfig.v.formId).find("#callbackTimeSlider").slider({range:"min",min:2,max:20,value:a,slide:function(b,c){$("#"+systemConfig.v.formId).find("#callbackTime").val(c.value)}});$("#"+systemConfig.v.formId).find("#callbackTime").val($("#"+systemConfig.v.formId).find("#callbackTimeSlider").slider("value"))},query:function(){jsonrpc.systemService.query(function(result,exception,profile){removeLoading($("#"+systemConfig.v.formId));if(exception){return}var data=result;if(data==null){return}data=eval("("+data+")");if(data["system.property.cron"]!=null&&data["system.property.cron"]!=""){selectRadio(systemConfig.v.formId,"system.property.cron",data["system.property.cron"])}$("#"+systemConfig.v.formId+" textarea[name='system.property.users']").val(data["system.property.users"]==null?"":data["system.property.users"]);$("#"+systemConfig.v.formId+" input[name='system.property.email']").val(data["system.property.email"]==null?"":data["system.property.email"]);$("#"+systemConfig.v.formId+" input[name='system.property.smtpHost']").val(data["system.property.smtpHost"]==null?"":data["system.property.smtpHost"]);$("#"+systemConfig.v.formId+" input[name='system.property.smtpPort']").val(data["system.property.smtpPort"]==null?"":data["system.property.smtpPort"]);$("#"+systemConfig.v.formId+" input[name='system.property.smtpUsername']").val(data["system.property.smtpUsername"]==null?"":data["system.property.smtpUsername"]);$("#"+systemConfig.v.formId+" input[name='system.property.smtpPassword']").val(data["system.property.smtpPassword"]==null?"":data["system.property.smtpPassword"]);$("#"+systemConfig.v.formId+" input[name='system.property.rpcAuth']").val(data["system.property.rpcAuth"]==null?"":data["system.property.rpcAuth"]);systemConfig.fn.initSlider(data["system.property.callbackTime"]==null?5:data["system.property.callbackTime"]);$("#"+systemConfig.v.formId).find("#urlfetchPluginId").val(data["system.property.urlfetchPluginId"]==null?"":data["system.property.urlfetchPluginId"]);$("#"+systemConfig.v.formId).find("#queueName").val(data["system.property.queueName"]==null?"":data["system.property.queueName"]);selectCheckbox(systemConfig.v.formId,"system.property.smtpSSL",data["system.property.smtpSSL"]);selectCheckbox("shareSpiderForm","system.property.share",data["system.property.share"])},systemConfig.v.webCrawlerId)},save:function(){var i=$("#"+systemConfig.v.formId+" input[name='system.property.email']").val();var a=$("#"+systemConfig.v.formId+" textarea[name='system.property.users']").val();var m=$("#"+systemConfig.v.formId+" input[name='system.property.smtpHost']").val();var c=$("#"+systemConfig.v.formId+" input[name='system.property.smtpPort']").val();var h=$("#"+systemConfig.v.formId+" input[name='system.property.smtpUsername']").val();var j=$("#"+systemConfig.v.formId+" input[name='system.property.smtpPassword']").val();var b=$("#"+systemConfig.v.formId+" input[name='system.property.rpcAuth']").val();var k=$("#"+systemConfig.v.formId+" input[name='callbackTime']").val();var f=getCheckbox(systemConfig.v.formId,"system.property.smtpSSL");var g=$("#"+systemConfig.v.formId).find("#urlfetchPluginId").val();var e=$("#"+systemConfig.v.formId).find("#queueName").val();var l={};l["system.property.cron"]=getRadio(systemConfig.v.formId,"system.property.cron");l["system.property.email"]=i;l["system.property.users"]=a;l["system.property.smtpHost"]=m;l["system.property.smtpPort"]=c;l["system.property.smtpUsername"]=h;l["system.property.smtpPassword"]=j;l["system.property.smtpSSL"]=f;l["system.property.urlfetchPluginId"]=g;l["system.property.callbackTime"]=k;l["system.property.queueName"]=e;l["system.property.rpcAuth"]=b;var d=$.toJSON(l);showLoading($("#"+systemConfig.v.formId));jsonrpc.systemService.save(function(n,o,p){removeLoading($("#"+systemConfig.v.formId));if(o){return}var q=n;if(q){showInfo(nc.i18n("res.save.success"))}else{showInfo(nc.i18n("res.save.failure"))}},systemConfig.v.webCrawlerId,d)},changeEmail:function(a){$("#"+systemConfig.v.formId+" input[name='system.property.smtpHost']").val("");$("#"+systemConfig.v.formId+" input[name='system.property.smtpPort']").val("465");if(a=="gmail"){$("#"+systemConfig.v.formId+" input[name='system.property.smtpHost']").val("smtp.gmail.com");$("#"+systemConfig.v.formId+" input[name='system.property.smtpUsername']").val("@gmail.com");selectCheckbox(systemConfig.v.formId,"system.property.smtpSSL","true")}else{if(a=="qq"){$("#"+systemConfig.v.formId+" input[name='system.property.smtpHost']").val("smtp.qq.com");$("#"+systemConfig.v.formId+" input[name='system.property.smtpUsername']").val("@qq.com");selectCheckbox(systemConfig.v.formId,"system.property.smtpSSL","true")}else{if(a=="163"){$("#"+systemConfig.v.formId+" input[name='system.property.smtpHost']").val("smtp.163.com");$("#"+systemConfig.v.formId+" input[name='system.property.smtpUsername']").val("@163.com");selectCheckbox(systemConfig.v.formId,"system.property.smtpSSL","false")}}}},shareSpider:function(){showLoading($("#shareSpiderForm"));var a=$("#shareSpiderForm input[name='system.property.share']");if(a.is(":checked")){jsonrpc.siteSpiderService.shareSpider(function(b,c,d){removeLoading($("#shareSpiderForm"));if(c){return}var e=b;if(e){showInfo(nc.i18n("res.share.success"))}else{showInfo(nc.i18n("res.share.failure"))}},systemConfig.v.webCrawlerId)}else{jsonrpc.siteSpiderService.removeShareSpider(function(b,c,d){removeLoading($("#shareSpiderForm"));if(c){return}var e=b;if(e){showInfo(nc.i18n("res.share.del.success"))}else{showInfo(nc.i18n("res.share.del.failure"))}},systemConfig.v.webCrawlerId)}}}};var cacheClear={v:{formId:"cacheClearForm"},fn:{clear:function(){jsonrpc.systemService.cacheClear(function(a,b,c){if(b){return}var d=a;if(d){showInfo(nc.i18n("res.app.crawler.cache.clear.success"))}else{showInfo(nc.i18n("res.app.crawler.cache.clear.failure"))}},systemConfig.v.webCrawlerId)}}};var dataClear={v:{formId:"dataClearForm"},fn:{clear:function(){var d="";var f=$("#"+dataClear.v.formId+" input[type=checkbox][name=tables]");for(var b=0,a=f.length;b<a;b++){if(f[b].checked){if(d==""){d=f[b].value}else{d+=","+f[b].value}}}var e=$("#"+dataClear.v.formId+" #siteList").val();if(e==null){showInfo(nc.i18n("res.site.select"));return}jsonrpc.systemService.dataClearService(function(c,g,h){if(g){return}showInfo(nc.i18n("res.clear.data"));jsonrpc.systemResetService.resetCache(function(i,j,k){})},systemConfig.v.webCrawlerId,e,d)},disabledAll:function(c,a){var b=c.checked;if(c.checked){$("#"+dataClear.v.formId+" input[type=checkbox][name="+a+"]").each(function(){this.checked=false;this.disabled=true})}else{$("#"+dataClear.v.formId+" input[type=checkbox][name="+a+"]").each(function(){this.checked=false;this.disabled=false})}c.disabled=false;c.checked=b}}};