var spiderPoolList={v:{formId:"spiderPoolForm",searchFormId:"spiderPoolSearchForm",tableId:"spiderPoolListTable",mainTableId:"spiderPoolTable",jsonData:new Array(),PER_PAGE_ITEMS:10,ITEMS_COUNT:0,cur_page:0},fn:{refresh:function(){spiderPoolList.fn.query(spiderPoolList.v.cur_page);spiderPoolList.fn.updateCount();spiderPoolList.fn.initPagination(spiderPoolList.v.cur_page);removeLoading($("#"+spiderPoolList.v.mainTableId))},create:function(){var a=$("#"+spiderPoolList.v.formId).find("#url").val();var b=$("#"+spiderPoolList.v.formId).find("#rpcAuth").val();var c=jsonrpc.spiderPoolRpcService.create(a,b);if(!isNum(c)){showInfo("添加爬虫池失败。");return}showInfo("添加爬虫池成功。");spiderPoolList.fn.refresh()},edit:function(e){var d=spiderPoolList.v.jsonData;for(var b in d){if(isNaN(b)){continue}if(e!=d[b]["id"]){continue}var e=d[b]["id"];var a=d[b]["url"];var c=d[b]["rpcAuth"];$("#"+spiderPoolList.v.formId).find("#id").val(e);$("#"+spiderPoolList.v.formId).find("#url").val(a);$("#"+spiderPoolList.v.formId).find("#rpcAuth").val(c)}},update:function(){var d=$("#"+spiderPoolList.v.formId).find("#id").val();if(d==null||d.length==0){showInfo("请选择一条记录。");return}var a=$("#"+spiderPoolList.v.formId).find("#url").val();var b=$("#"+spiderPoolList.v.formId).find("#rpcAuth").val();var c=jsonrpc.spiderPoolRpcService.update(d,a,b);if(!c){showInfo("更新爬虫池失败。");return}showInfo("更新爬虫池成功。");spiderPoolList.fn.query(spiderPoolList.v.cur_page)},statistic:function(){var a=jsonrpc.spiderPoolRpcService.statistic();if(a){showInfo("已启动后台统计任务。")}else{showInfo("执行统计任务失败。")}},query:function(a){var c=a*spiderPoolList.v.PER_PAGE_ITEMS;moveAllTr(spiderPoolList.v.tableId);queryLoading(spiderPoolList.v.tableId);var b=jsonrpc.spiderPoolRpcService.query(function(d,e,f){if(e){return}moveAllTr(spiderPoolList.v.tableId);var g=d;spiderPoolList.fn.showData(g)})},showData:function(data){data=eval(data);spiderPoolList.v.jsonData=data;var index=1;for(var i in data){if(isNaN(i)){continue}var id=data[i]["id"];var url=data[i]["url"];var rpcAuth=data[i]["rpcAuth"];var createDate=data[i]["createDate"];spiderPoolList.fn.addRow(index,id,url,rpcAuth,createDate);index++}$("#"+spiderPoolList.v.tableId).find("tr:odd").css("background","#FFFFFF");$("#"+spiderPoolList.v.tableId).find("tr:even").css("background","rgb(247, 247, 247)");$("#"+spiderPoolList.v.tableId).find(".simplehighlight").hover(function(){$(this).children().addClass("datahighlight")},function(){$(this).children().removeClass("datahighlight")})},addRow:function(c,f,b,e,d){var a="<tr class='simplehighlight'>";a+="<td nowrap>"+c+"</td>";a+="<td nowrap>"+b+"</td>";a+="<td nowrap>&nbsp; "+e+"</td>";a+="<td nowrap>&nbsp; "+d+"</td>";a+='<td nowrap style="text-align:center"> <a href="javascript:void(0)" onclick="spiderPoolList.fn.edit('+f+')" >编辑</a> </td>';a+="</tr>";$(a).appendTo("#"+spiderPoolList.v.tableId)},updateCount:function(){spiderPoolList.v.ITEMS_COUNT=jsonrpc.spiderPoolRpcService.count();$("#"+spiderPoolList.v.mainTableId).find("#USERGROUP_COUNT").html(spiderPoolList.v.ITEMS_COUNT)},initPagination:function(a){$("#"+spiderPoolList.v.mainTableId).find("#Pagination").pagination(spiderPoolList.v.ITEMS_COUNT,{num_edge_entries:2,num_display_entries:8,current_page:a,callback:spiderPoolList.fn.pageselectCallback,items_per_page:spiderPoolList.v.PER_PAGE_ITEMS,prev_text:"上一页",next_text:"下一页"})},pageselectCallback:function(a,b){spiderPoolList.v.cur_page=a;spiderPoolList.fn.query(spiderPoolList.v.cur_page);return false}}};$(document).ready(function(){spiderPoolList.fn.refresh()});