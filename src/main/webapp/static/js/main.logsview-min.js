var logsView={v:{tableId:"logsViewTable",listTableId:"logsViewList",webCrawlerId:null,PER_PAGE_ITEMS:20,cur_page:0,prevOffset:new Array(),readFileName:null,readOffsetNext:0,autoRefreshFun:null,scrollLock:false},fn:{init:function(){logsView.v.readFileName=null;logsView.v.readOffsetNext=0;logsView.v.cur_page=0;logsView.v.prevOffset[0]="";logsView.fn.query(0,null)},prev:function(a){offset=logsView.v.prevOffset[a];logsView.fn.query(a,offset)},next:function(a,b){logsView.v.prevOffset[a]=b;logsView.fn.query(a,b)},query:function(cur_page,offset){logsView.v.cur_page=cur_page;jsonrpc.appLogsService.query(function(result,exception,profile){removeLoading($("#"+logsView.v.tableId));if(exception){return}moveAllTr(logsView.v.tableId+" #"+logsView.v.listTableId);var data=eval("("+result+")");logsView.fn.showData(data.list);logsView.fn.initPagination(logsView.v.cur_page,data.hasNext,data.nextOffset,data.count)},logsView.v.webCrawlerId,logsView.v.PER_PAGE_ITEMS,offset)},closeLog:function(){logsView.v.scrollLock=false;logsView.v.readOffsetNext=0;if(logsView.v.autoRefreshFun!=null){clearInterval(logsView.v.autoRefreshFun)}},readLogFile:function(a){logsView.v.scrollLock=false;logsView.v.readOffsetNext=0;if(logsView.v.autoRefreshFun!=null){clearInterval(logsView.v.autoRefreshFun)}$("#log-box-file").dialog("open");$("#log-box-file #log").html("");$(".ui-dialog-buttonpane .ui-dialog-buttonset .autoRefreshHtml").remove();$(".ui-dialog-buttonpane .ui-dialog-buttonset .scrollLockHtml").remove();var b='<span class="autoRefreshHtml" style="padding-right: 8px;"><input name="autoRefresh" type="checkbox" id="autoRefresh" value="true" onclick="logsView.fn.autoRefresh(this.checked)" class="jfk-checkbox"> <a class="tooltip" style="font-weight:normal;" title="Show Console When Standard Out Changes" href="javascript:void(0);">Auto Refresh</a></span>';var c='<span class="scrollLockHtml" style="padding-right: 8px;"><input name="scrollLock" type="checkbox" id="scrollLock" value="true" onclick="logsView.fn.scrollLock(this.checked)" class="jfk-checkbox"> <a class="tooltip" style="font-weight:normal;" title="Scroll Lock" href="javascript:void(0);">Scroll Lock</a></span>';$("#log-box-file").parent().find(".ui-dialog-buttonpane .ui-dialog-buttonset").prepend(b);$("#log-box-file").parent().find(".ui-dialog-buttonpane .ui-dialog-buttonset").prepend(c);logsView.v.readFileName=a;logsView.fn.readFile(a,0)},scrollLock:function(a){logsView.v.scrollLock=a;if(!logsView.v.scrollLock){$("#log-box-file").animate({scrollTop:$("#log-box-file #log")[0].scrollHeight},0)}},autoRefresh:function(a){$("#log-box-file #log").html("");if(a){jsonrpc.appLogsService.readLogFilePointer(function(b,c,d){if(c){return}logsView.v.readOffsetNext=b;logsView.v.autoRefreshFun=setInterval(function(){logsView.fn.readFileNext()},1500)},logsView.v.webCrawlerId,logsView.v.readFileName)}else{clearInterval(logsView.v.autoRefreshFun)}},readFileNext:function(){logsView.fn.readFile(logsView.v.readFileName,logsView.v.readOffsetNext)},readFile:function(filename,offset){jsonrpc.appLogsService.readLogFile(function(result,exception,profile){removeLoading($("#"+logsView.v.tableId));if(exception){return}var data=eval("("+result+")");logsView.v.readOffsetNext=data.nextOffset;var content=data.content;if(content==null||content==""){return}$("#log-box-file #log").append(content);if(!logsView.v.scrollLock){$("#log-box-file").animate({scrollTop:$("#log-box-file #log")[0].scrollHeight},0)}},logsView.v.webCrawlerId,filename,50,offset)},showData:function(e){var b=1;for(var c in e){if(isNaN(c)){continue}var a="<tr class='simplehighlight'>";a+="<td nowrap>"+b+"</td>";if(e[c]["isFile"]){var f=getWebCrawlerUrl();var d=f+"logs";a+="<td nowrap>&nbsp; <a href='javascript:void(0);' target='_blank' onclick='logsView.fn.readLogFile(\""+e[c]["message"]+"\")'>"+e[c]["message"]+"</a>&nbsp; &nbsp; </td>"}else{a+="<td nowrap><pre style='white-space: pre-wrap;word-wrap: break-word;'> "+e[c]["message"]+"</pre> </td>"}a+="<td nowrap  style='text-align: right;  padding-right: 30px;'>&nbsp; "+e[c]["length"]+"&nbsp; </td>";a+="<td nowrap  style='text-align: center;'>&nbsp; "+e[c]["createDate"]+"&nbsp;&nbsp; </td>";a+="</tr>";b++;$(a).appendTo("#"+logsView.v.tableId+" #"+logsView.v.listTableId)}$("#"+logsView.v.tableId).find("#"+logsView.v.listTableId).find("tr:odd").css("background","#FFFFFF");$("#"+logsView.v.tableId).find("#"+logsView.v.listTableId).find("tr:even").css("background","rgb(247, 247, 247)");$("#"+logsView.v.tableId).find("#"+logsView.v.listTableId).find(".simplehighlight").hover(function(){$(this).children().addClass("datahighlight")},function(){$(this).children().removeClass("datahighlight")})},initPagination:function(c,a,h,f){var i='<div class="ae-paginate">';if(c==0){i+='<span class="ae-disabled ae-paginate-prev">‹ Prev '+logsView.v.PER_PAGE_ITEMS+"</span>"}else{var d=c-1;i+='<span class="ae-paginate-prev ae-action" onclick="logsView.fn.prev('+d+')">‹ Prev '+logsView.v.PER_PAGE_ITEMS+"</span>"}var b=logsView.v.PER_PAGE_ITEMS*c+1;var g=logsView.v.PER_PAGE_ITEMS*c+f;i+="<strong>"+b+"-"+g+"</strong>";if(a){var e=c+1;i+='<span class="ae-paginate-next ae-action" onclick="logsView.fn.next('+e+",'"+h+"')\">Next "+logsView.v.PER_PAGE_ITEMS+" ›</span>"}else{i+='<span class="ae-disabled ae-paginate-next">Next '+logsView.v.PER_PAGE_ITEMS+" ›</span>"}i+="</div>";$("#"+logsView.v.tableId).find("#Pagination").html(i)}}};