var accountList={v:{formId:"accountForm",searchFormId:"accountSearchForm",tableId:"accountListTable",mainTableId:"accountTable",jsonData:new Array(),PER_PAGE_ITEMS:10,ITEMS_COUNT:0,cur_page:0},fn:{init:function(){var userGroupData=jsonrpc.userGroupRpcService.query();userGroupData=eval(userGroupData);for(var i in userGroupData){if(isNaN(i)){continue}var id=userGroupData[i]["id"];var description=userGroupData[i]["description"];addOption(accountList.v.formId,"userGroupId",description,id,false)}removeLoading($("#"+accountList.v.mainTableId))},refresh:function(){accountList.fn.query(accountList.v.cur_page);accountList.fn.updateCount();accountList.fn.initPagination(accountList.v.cur_page)},create:function(){var e=$("#"+accountList.v.formId).find("#username").val();var j=$("#"+accountList.v.formId).find("#password").val();var h=$("#"+accountList.v.formId).find("#email").val();var i=$("#"+accountList.v.formId).find("#description").val();var f=$("#"+accountList.v.formId).find("#role").val();var g=$("#"+accountList.v.formId).find("#userGroupId").val();var d=$("#"+accountList.v.formId).find("#status").val();var b=$("#"+accountList.v.formId).find("#telephone").val();var c=$("#"+accountList.v.formId).find("#expiryDate").val();var a=jsonrpc.accountService.create(e,j,h,i,f,g,d,b,c);if(!isNum(a)){showInfo("添加用户失败。");return}showInfo("添加用户成功。");accountList.fn.refresh()},resetKey:function(){var b=$("#"+accountList.v.formId).find("#id").val();if(b==null||b.length==0){showInfo("请选择一条记录。");return}var a=jsonrpc.accountService.resetKey(b);if(!a){showInfo("重置密钥失败。");return}showInfo("重置密钥成功。")},edit:function(a){var g=accountList.v.jsonData;for(var h in g){if(isNaN(h)){continue}if(a!=g[h]["id"]){continue}var a=g[h]["id"];var e=g[h]["username"];var k=g[h]["email"];var l=g[h]["description"];var f=g[h]["role"];var j=g[h]["userGroupId"];var d=g[h]["status"];var b=g[h]["telephone"];var c=g[h]["expiryDate"];$("#"+accountList.v.formId).find("#id").val(a);$("#"+accountList.v.formId).find("#username").val(e);$("#"+accountList.v.formId).find("#email").val(k);$("#"+accountList.v.formId).find("#description").val(l);$("#"+accountList.v.formId).find("#role").val(f);$("#"+accountList.v.formId).find("#userGroupId").val(j);$("#"+accountList.v.formId).find("#status").val(d);$("#"+accountList.v.formId).find("#telephone").val(b);$("#"+accountList.v.formId).find("#expiryDate").val(c)}},update:function(){var a=$("#"+accountList.v.formId).find("#id").val();if(a==null||a.length==0){showInfo("请选择一条记录。");return}var f=$("#"+accountList.v.formId).find("#username").val();var k=$("#"+accountList.v.formId).find("#password").val();var i=$("#"+accountList.v.formId).find("#email").val();var j=$("#"+accountList.v.formId).find("#description").val();var g=$("#"+accountList.v.formId).find("#role").val();var h=$("#"+accountList.v.formId).find("#userGroupId").val();var e=$("#"+accountList.v.formId).find("#status").val();var c=$("#"+accountList.v.formId).find("#telephone").val();var d=$("#"+accountList.v.formId).find("#expiryDate").val();var b=jsonrpc.accountService.update(a,f,k,i,j,g,h,e,c,d);if(!b){showInfo("更新用户失败。");return}showInfo("更新用户成功。");accountList.fn.query(accountList.v.cur_page)},statistic:function(){var a=jsonrpc.accountService.statistic();if(a){showInfo("已启动后台统计任务。")}else{showInfo("执行统计任务失败。")}},search:function(){var a=$("#"+accountList.v.searchFormId).find("#username").val();jsonrpc.accountService.query(function(b,c,d){if(c){return}moveAllTr(accountList.v.tableId);$("#"+accountList.v.mainTableId).find("#Pagination").html("");var e=b;accountList.fn.showData(e)},a)},query:function(a){var b=a*accountList.v.PER_PAGE_ITEMS;moveAllTr(accountList.v.tableId);queryLoading(accountList.v.tableId);jsonrpc.accountService.query(function(c,d,e){if(d){return}moveAllTr(accountList.v.tableId);var f=c;accountList.fn.showData(f)},b,accountList.v.PER_PAGE_ITEMS)},showData:function(data){data=eval(data);accountList.v.jsonData=data;var index=1;for(var i in data){if(isNaN(i)){continue}var id=data[i]["id"];var username=data[i]["username"];var email=data[i]["email"];var description=data[i]["description"];var role=data[i]["role"];var userGroupId=data[i]["userGroupId"];var status=data[i]["status"];var createDate=data[i]["createDate"];var telephone=data[i]["telephone"];var expiryDate=data[i]["expiryDate"];if(expiryDate==null){expiryDate=""}accountList.fn.addRow(index,id,username,email,description,role,userGroupId,status,expiryDate,createDate,telephone);index++}$("#"+accountList.v.tableId).find("tr:odd").css("background","#FFFFFF");$("#"+accountList.v.tableId).find("tr:even").css("background","rgb(247, 247, 247)");$("#"+accountList.v.tableId).find(".simplehighlight").hover(function(){$(this).children().addClass("datahighlight")},function(){$(this).children().removeClass("datahighlight")})},addRow:function(g,a,e,j,n,f,i,d,c,m,b){var o=getSelectText(accountList.v.formId,"role",f);var h=getSelectText(accountList.v.formId,"userGroupId",i);var l=getSelectText(accountList.v.formId,"status",d);b=(b==null?"":b);n=(n==null?"":n);var k="<tr class='simplehighlight'>";k+="<td nowrap>"+g+"</td>";k+="<td nowrap>"+e+"</td>";k+="<td nowrap>&nbsp; "+j+"</td>";k+="<td nowrap>&nbsp; "+b+"</td>";k+="<td nowrap>&nbsp; "+n+"</td>";k+="<td nowrap>&nbsp; "+o+"</td>";k+="<td nowrap>&nbsp; "+h+"</td>";k+="<td nowrap>&nbsp; "+l+"</td>";k+="<td nowrap>&nbsp; "+c+"&nbsp; &nbsp; </td>";k+="<td nowrap>&nbsp; "+m+"&nbsp; &nbsp; </td>";k+='<td nowrap style="text-align:center"> <a href="javascript:void(0)" onclick="accountList.fn.edit('+a+')" >编辑</a> </td>';k+="</tr>";$(k).appendTo("#"+accountList.v.tableId)},updateCount:function(){accountList.v.ITEMS_COUNT=jsonrpc.accountService.count();$("#"+accountList.v.mainTableId).find("#ACCOUNT_COUNT").html(accountList.v.ITEMS_COUNT)},initPagination:function(a){$("#"+accountList.v.mainTableId).find("#Pagination").pagination(accountList.v.ITEMS_COUNT,{num_edge_entries:2,num_display_entries:8,current_page:a,callback:accountList.fn.pageselectCallback,items_per_page:accountList.v.PER_PAGE_ITEMS,prev_text:"上一页",next_text:"下一页"})},pageselectCallback:function(a,b){accountList.v.cur_page=a;accountList.fn.query(accountList.v.cur_page);return false}}};$(document).ready(function(){$("#"+accountList.v.formId).find("#expiryDate").datetimepicker({format:"Y-m-d H:i:s",lang:"ch"});accountList.fn.init();accountList.fn.refresh()});