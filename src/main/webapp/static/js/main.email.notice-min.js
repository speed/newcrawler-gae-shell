function emailNoticeFun(option){function isEmpty(pString){if(pString==null||pString.length==0){return true}return false}var emailNotice={v:{formId:"emailNoticeForm",tableId:"emailNoticeTable",webCrawlerId:null,jsonData:new Array()},fn:{init:function(){$("#"+obj.v.formId).find(".create").click(function(){obj.fn.create()});$("#"+obj.v.formId).find(".remove").click(function(){obj.fn.remove()});$("#"+obj.v.formId).find(".update").click(function(){obj.fn.update()});$("#"+obj.v.formId).find(".testEmail").click(function(){obj.fn.testEmail()})},testEmail:function(){var id=getRadio(obj.v.formId,"emailNoticeList");if(id==null||id.length==0){showInfo(nc.i18n("res.select"));return false}showLoading($("#"+obj.v.formId));jsonrpc.emailNoticeService.testEmail(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}var msg=result;showInfo(msg)},obj.v.webCrawlerId,id)},query:function(callback){moveAllTr(obj.v.tableId);queryLoading(obj.v.tableId);jsonrpc.emailNoticeService.query(function(result,exception,profile){if(exception){removeLoading($("#"+obj.v.formId));return}moveAllTr(obj.v.tableId);if(result!=null&&result!=""){var data=result;data="("+data+")";data=eval(data);obj.v.jsonData=data;var key=""+obj.v.webCrawlerId;emailNoticeMap.put(key,data);for(var i in data){if(isNaN(i)){continue}var id=data[i]["id"];var toEmail=data[i]["toEmail"];var tempTitle=data[i]["tempTitle"];var tempContent=data[i]["tempContent"];var name=data[i]["name"];var createDate=data[i]["createDate"];var isAttachment=data[i]["isAttachment"];obj.fn.addRow(id,toEmail,tempTitle,tempContent,name,createDate,isAttachment)}}removeLoading($("#"+obj.v.formId));callback()},obj.v.webCrawlerId)},edit:function(id){var data=obj.v.jsonData;for(var i in data){if(isNaN(i)){continue}if(id!=data[i]["id"]){continue}var toEmail=data[i]["toEmail"];var tempTitle=data[i]["tempTitle"];var tempContent=data[i]["tempContent"];var name=data[i]["name"];var createDate=data[i]["createDate"];var isAttachment=data[i]["isAttachment"];$("#"+obj.v.formId).find("#id").val(id);$("#"+obj.v.formId).find("#name").val(name);$("#"+obj.v.formId).find("#toEmail").val(toEmail);$("#"+obj.v.formId).find("#tempTitle").val(tempTitle);$("#"+obj.v.formId).find("#tempContent").val(tempContent);selectCheckbox(obj.v.formId,"isAttachment",isAttachment);return}},create:function(){var id=$("#"+obj.v.formId).find("#id").val();var name=$("#"+obj.v.formId).find("#name").val();var toEmail=$("#"+obj.v.formId).find("#toEmail").val();var tempTitle=$("#"+obj.v.formId).find("#tempTitle").val();var tempContent=$("#"+obj.v.formId).find("#tempContent").val();var isAttachment=getCheckbox(obj.v.formId,"isAttachment");showLoading($("#"+obj.v.formId));jsonrpc.emailNoticeService.create(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}var id=result;if(!isNum(id)){showInfo(nc.i18n("res.create.failure"));return}showInfo(nc.i18n("res.create.success"));obj.fn.query();updateSelect(id,name,"emailNoticeId")},obj.v.webCrawlerId,toEmail,tempTitle,tempContent,name,isAttachment)},update:function(){var id=getRadio(obj.v.formId,"emailNoticeList");if(id==null||id.length==0){showInfo(nc.i18n("res.select"));return false}var name=$("#"+obj.v.formId).find("#name").val();var toEmail=$("#"+obj.v.formId).find("#toEmail").val();var tempTitle=$("#"+obj.v.formId).find("#tempTitle").val();var tempContent=$("#"+obj.v.formId).find("#tempContent").val();var isAttachment=getCheckbox(obj.v.formId,"isAttachment");showLoading($("#"+obj.v.formId));jsonrpc.emailNoticeService.update(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}id=result;if(!isNum(id)){showInfo(nc.i18n("res.update.failure"));return}showInfo(nc.i18n("res.update.success"));obj.fn.query();updateSelect(id,name,"emailNoticeId")},obj.v.webCrawlerId,id,toEmail,tempTitle,tempContent,name,isAttachment)},remove:function(id){var id=getRadio(obj.v.formId,"emailNoticeList");if(id==null||id.length==0){showInfo(nc.i18n("res.select"));return false}if(!confirm(nc.i18n("res.remove.confirm"))){return}showLoading($("#"+obj.v.formId));jsonrpc.emailNoticeService.remove(function(result,exception,profile){removeLoading($("#"+obj.v.formId));if(exception){return}var msg=result;if(msg){showInfo(nc.i18n("res.remove.success"));obj.fn.query();removeSelect(id,"emailNoticeId");return}showInfo(nc.i18n("res.remove.failure"))},obj.v.webCrawlerId,id)},addRow:function(id,toEmail,tempTitle,tempContent,name,createDate,isAttachment){if(isAttachment=="Y"){isAttachment=nc.i18n("res.yes")}else{isAttachment=nc.i18n("res.no")}var newTr="<tr class='simplehighlight'>";newTr+='<td nowrap>&nbsp;<input type="radio" name="emailNoticeList" id="emailNoticeList" value="'+id+'" class="edit"/></td>';newTr+="<td nowrap>&nbsp;&nbsp;&nbsp;"+name+"</td>";newTr+="<td>";newTr+=nc.i18n("res.isAttachment")+isAttachment+"<br/>";newTr+=nc.i18n("res.toEmail")+toEmail+"<br/>";newTr+=nc.i18n("res.tempTitle")+tempTitle+"<br/>";newTr+=nc.i18n("res.tempContent")+"<br/>";newTr+='<pre id="tempContent-'+id+'" style="width:99%;border:0px;"></pre>';newTr+="</td>";newTr+="<td nowrap>"+createDate+"</td>";newTr+="</tr>";var newTrObj=$(newTr);newTrObj.find(".edit").click(function(){obj.fn.edit($(this).val())});newTrObj.find("#tempContent-"+id).html(tempContent);newTrObj.appendTo("#"+obj.v.tableId);$("#"+obj.v.tableId).find("tr:odd").css("background","#FFFFFF");$("#"+obj.v.tableId).find("tr:even").css("background","rgb(247, 247, 247)")}}};var obj=this;obj.fn=emailNotice.fn;obj.v=option}var emailNotice=new emailNoticeFun();