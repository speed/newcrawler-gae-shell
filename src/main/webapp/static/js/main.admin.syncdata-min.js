var syncDataList={v:{tableId:"syncDataListTable",mainTableId:"syncDataTable",PER_PAGE_ITEMS:10,ITEMS_COUNT:0,cur_page:0},fn:{refresh:function(){syncDataList.fn.query(syncDataList.v.cur_page);syncDataList.fn.updateCount();syncDataList.fn.initPagination(syncDataList.v.cur_page);removeLoading($("#"+syncDataList.v.mainTableId));jsonrpc.syncDataRpcService.getips(function(result,exception,profile){if(exception){return}var data=eval(result);for(var i in data){if(isNaN(i)){continue}var optionHTML='<option value="'+data[i]+'">'+data[i]+"</option>";$(optionHTML).appendTo("#"+syncDataList.v.mainTableId+" #syncIP")}})},remove:function(){var a="";$("#"+syncDataList.v.mainTableId).find(":checkbox[name=selectedId]:checked").each(function(){if(a!=""){a+=","}a+=this.value});jsonrpc.syncDataRpcService.remove(function(b,c,d){if(c){return}if(b){$("#"+syncDataList.v.mainTableId).find(":checkbox[name=selectedId]:checked").each(function(){$(this).parent().parent().remove()});showInfo("删除成功。")}else{showInfo("删除失败。")}},a)},sync:function(){var a=$("#"+syncDataList.v.mainTableId+" #syncIP").val();jsonrpc.syncDataRpcService.sync(function(b,c,d){if(c){return}if(b){showInfo("同步成功。")}else{showInfo("已锁无法同步。")}},a)},statistic:function(){var a=jsonrpc.syncDataRpcService.statistic();if(a){showInfo("已启动后台统计任务。")}else{showInfo("执行统计任务失败。")}},query:function(a){var c=a*syncDataList.v.PER_PAGE_ITEMS;moveAllTr(syncDataList.v.tableId);queryLoading(syncDataList.v.tableId);var b=jsonrpc.syncDataRpcService.query(function(d,e,f){if(e){return}moveAllTr(syncDataList.v.tableId);var g=d;syncDataList.fn.showData(g)},c,syncDataList.v.PER_PAGE_ITEMS)},showData:function(data){data=eval(data);var index=1;for(var i in data){if(isNaN(i)){continue}syncDataList.fn.addRow(index,data[i]);index++}$("#"+syncDataList.v.tableId).find("tr:odd").css("background","#FFFFFF");$("#"+syncDataList.v.tableId).find("tr:even").css("background","rgb(247, 247, 247)");$("#"+syncDataList.v.tableId).find(".simplehighlight").hover(function(){$(this).children().addClass("datahighlight")},function(){$(this).children().removeClass("datahighlight")})},addRow:function(i,f){var c=f.id;var j=f.ip;var h=f.api;var k=f.hessian;var a=f.method;var e=f.status;var b=f.times;var m=f.createDate;var g=f.updateDate;var d=f.exception;var l="<tr class='simplehighlight' id='item_"+c+"'>";l+="<td nowrap>"+i+"</td>";l+='<td nowrap><input type="checkbox" name="selectedId" value="'+c+'"/></td>';l+="<td nowrap>&nbsp; "+j+"</td>";l+="<td nowrap>&nbsp; "+h+"</td>";l+="<td nowrap>&nbsp; "+k+"</td>";l+="<td nowrap>&nbsp; "+a+"</td>";l+='<td nowrap><pre class="exception">&nbsp;</pre></td>';l+="<td nowrap>&nbsp; "+e+"</td>";l+="<td nowrap>&nbsp; "+b+"</td>";l+="<td nowrap>&nbsp; "+m+"</td>";l+="<td nowrap>&nbsp; "+(g==null?"":g)+"</td>";l+="</tr>";$(l).appendTo("#"+syncDataList.v.tableId);$("#"+syncDataList.v.tableId).find("#item_"+c).find(".exception").text(d)},updateCount:function(){syncDataList.v.ITEMS_COUNT=jsonrpc.syncDataRpcService.count();$("#"+syncDataList.v.mainTableId).find("#SYNCDATA_COUNT").html(syncDataList.v.ITEMS_COUNT)},initPagination:function(a){$("#"+syncDataList.v.mainTableId).find("#Pagination").pagination(syncDataList.v.ITEMS_COUNT,{num_edge_entries:2,num_display_entries:8,current_page:a,callback:syncDataList.fn.pageselectCallback,items_per_page:syncDataList.v.PER_PAGE_ITEMS,prev_text:"上一页",next_text:"下一页"})},pageselectCallback:function(a,b){syncDataList.v.cur_page=a;syncDataList.fn.query(syncDataList.v.cur_page);return false}}};$(document).ready(function(){syncDataList.fn.refresh()});