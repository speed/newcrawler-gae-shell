var fileDownloadStatusList={v:{PER_PAGE_ITEMS:10,ITEMS_COUNT:0,cur_page:0,formId:"fileDownloadStatusListTable",tableId:"fileDownloadStatusList",webCrawlerId:null,siteId:null},fn:{init:function(){fileDownloadStatusList.v.cur_page=0;fileDownloadStatusList.v.ITEMS_COUNT=0;jsonrpc.siteSpiderService.query(function(result,exception,profile){if(exception){return}var data=result;data=eval(data);for(var i in data){if(isNaN(i)){continue}var spiderUrl=data[i]["url"];var project=data[i]["project"];if(project!=null&&project=="SPIDER-POOL"){jsonrpc.spiderPoolService.query(function(result,exception,profile){var spiderData=result;spiderData="("+spiderData+")";spiderData=eval(spiderData);if(spiderData.code=="1"){spiderData=eval(spiderData.message);for(var i in spiderData){if(isNaN(i)){continue}spiderUrl=spiderData[i]["url"];addOption(fileDownloadStatusList.v.formId,"spiderList",spiderUrl,spiderUrl,false)}}},spiderUrl)}else{addOption(fileDownloadStatusList.v.formId,"spiderList",spiderUrl,spiderUrl,false)}}fileDownloadStatusList.fn.refresh()},fileDownloadStatusList.v.webCrawlerId)},refresh:function(){fileDownloadStatusList.fn.updateCount()},changeSpider:function(a){fileDownloadStatusList.fn.refresh()},statistic:function(){var a=$("#"+fileDownloadStatusList.v.formId).find("#spiderList").val();showLoading($("#"+fileDownloadStatusList.v.formId));jsonrpc.fileDownloadStatusService.statistic(function(b,c,d){removeLoading($("#"+fileDownloadStatusList.v.formId));if(c){return}var e=b;if(e){showInfo(nc.i18n("res.background.statistics"))}else{showInfo(nc.i18n("res.background.statistics.failure"))}},fileDownloadStatusList.v.webCrawlerId,fileDownloadStatusList.v.siteId,a)},updateCount:function(){var a=$("#"+fileDownloadStatusList.v.formId).find("#spiderList").val();jsonrpc.fileDownloadStatusService.count(function(b,c,d){if(c){return}fileDownloadStatusList.v.ITEMS_COUNT=b;$("#"+fileDownloadStatusList.v.formId).find("#ITEM_COUNT").html(fileDownloadStatusList.v.ITEMS_COUNT);fileDownloadStatusList.fn.query(fileDownloadStatusList.v.cur_page);fileDownloadStatusList.fn.initPagination(fileDownloadStatusList.v.cur_page)},fileDownloadStatusList.v.webCrawlerId,fileDownloadStatusList.v.siteId,a)},query:function(cur_page){moveAllTr(fileDownloadStatusList.v.tableId);queryLoading(fileDownloadStatusList.v.tableId);var spiderUrl=$("#"+fileDownloadStatusList.v.formId).find("#spiderList").val();var startIndex=cur_page*fileDownloadStatusList.v.PER_PAGE_ITEMS;jsonrpc.fileDownloadStatusService.query(function(result,exception,profile){if(exception){removeLoading($("#"+fileDownloadStatusList.v.formId));return}moveAllTr(fileDownloadStatusList.v.tableId);var data=result;data=eval(data);var index=1;for(var i in data){if(isNaN(i)){continue}var status=data[i]["status"];var statusDesc=nc.i18n("res.download.status.downloading");if(status==-1){statusDesc=nc.i18n("res.download.status.failure")}else{if(status==-4){statusDesc=nc.i18n("res.download.status.exception")}else{if(status==1){statusDesc=nc.i18n("res.download.status.completed")}}}var content="";content+=nc.i18n("res.file.download.list.originalFile")+data[i]["originalFile"]+"<br/>";content+=nc.i18n("res.file.download.list.targetFile")+data[i]["targetFile"]+"<br/>";content+=nc.i18n("res.file.download.list.percentage")+data[i]["percentage"]+"%<br/>";content+=nc.i18n("res.file.download.list.rate")+data[i]["rate"]+"KB/S<br/>";content+=nc.i18n("res.file.download.list.status")+statusDesc+"<br/>";content+=nc.i18n("res.file.download.list.message")+data[i]["message"]+"<br/>";var newTr="<tr class='simplehighlight'>";newTr+="<td nowrap>"+index+"</td>";newTr+="<td nowrap>"+content+"</td>";newTr+="<td nowrap>"+data[i]["createDate"]+"</td>";newTr+="</tr>";$(newTr).appendTo("#"+fileDownloadStatusList.v.tableId);index++}$("#"+fileDownloadStatusList.v.tableId).find("tr:odd").css("background","#FFFFFF");$("#"+fileDownloadStatusList.v.tableId).find("tr:even").css("background","rgb(247, 247, 247)");removeLoading($("#"+fileDownloadStatusList.v.formId))},fileDownloadStatusList.v.webCrawlerId,fileDownloadStatusList.v.siteId,startIndex,fileDownloadStatusList.v.PER_PAGE_ITEMS,spiderUrl)},initPagination:function(a){$("#"+fileDownloadStatusList.v.formId).find("#Pagination").pagination(fileDownloadStatusList.v.ITEMS_COUNT,{num_edge_entries:2,num_display_entries:8,current_page:a,callback:fileDownloadStatusList.fn.pageselectCallback,items_per_page:fileDownloadStatusList.v.PER_PAGE_ITEMS,prev_text:nc.i18n("res.page.prev"),next_text:nc.i18n("res.page.next")})},pageselectCallback:function(a,b){fileDownloadStatusList.v.cur_page=a;showLoading($("#"+fileDownloadStatusList.v.formId));fileDownloadStatusList.fn.query(fileDownloadStatusList.v.cur_page);return false}}};